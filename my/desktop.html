<link rel="stylesheet" href="//static.zalora.com/css/global.css">
<div id="createPreview"></div>

<script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
<script>
    function fetchDataFromExcel() {
        $.getJSON("https://script.google.com/macros/d/M2KxfsM1dKv9IBeiU_1LO1mvQK42F7hHE/edit?uiv=2&mid=ACjPJvG-J41H2aBajVvveABbxSi5T1o9EFoxCgMtzEI-ZzwI1C1nMsD3WDGrZjRhEW4cnEEM2a76HdoS4TgkXs30j7Z3gm-jmE-bhgBDYoPO0DRp-N7IxLbyOjrGWJrXq4KaTskezTu6fNc&sheet=MYJSONSerialize", function (data) {
            var html = data.MYJSONSerialize[0].Desktop;

            //construct cdn url based on country
            var cdnURL = "https://static-my.zacdn.com";

            //render the html
            $("#createPreview").html(html);

            //update img src links
            $("img").each(function () {
                var imageURL = $(this).attr("src");
                imageURL = imageURL.replace("[MEDIA_BASE_URL]", cdnURL);
                $(this).attr("src", imageURL);
            });

            //preview hacks for perfect previews
            $("body").css("margin", "0 auto");
            $("body").css("width", "996px");
            $(".cms-full:last").css("margin-bottom", "200px");

        });
    }

    $(function () {
        fetchDataFromExcel();
    });
</script>
